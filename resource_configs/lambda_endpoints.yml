# ServerlessFramework Syntax

# Authorizer Lambda
# ....

textMessage:
  description: >-
    Uses nodeModuleLayer for Twillio API
    Parses input and send text message
  timeout: 10
  handler: functions/textMessage.call
  layers:
    - !Ref TwilioLambdaLayer
    - !Ref UuidLambdaLayer
    - !Ref ServicesLambdaLayer
  role: textMessageRole
  environment:
    MEMBER_TABLE: ${self:provider.environment.MEMBER_TABLE}
    TWILLIO_ACCOUNT_NUMBER: ${ssm(${self:provider.region}):twillio-account-number}
    TWILLIO_ACCOUNT_SID: ${ssm(${self:provider.region}):twillio-account-sid}
    TWILLIO_AUTH_TOKEN: ${ssm(${self:provider.region}):twillio-auth-token}
  events:
    - http:
        path: /text/{memberId}
        method: post
        request:
          parameters:
            paths:
              memberId: true
        cors: true
        # authorization: eventually
